<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no"/>
		<title>1227音悦tai</title>
		<link rel="stylesheet" type="text/css" href="css/index.css"/>
	</head>
	<body>
		<section id="wrap">
			<header id="head">
				<!--头部的上半部分-->
				<div id="headT">
					<!--logo-->
					<h1 id="logo">
						<a href="javascript:;">
							<img src="img/logo.png" />
						</a>
					</h1>
					<!--面包导航-->
					<a href="javascript:;" id="menuBtn" class="menuBtnClos"></a>
					<!--按钮排-->
					<div id="btns">
						<a href="javascript:;" id="searchBtn">搜索</a>
						<a href="javascript:;">登陆</a>
						<a href="javascript:;">注册</a>
					</div>
				</div>
				<!--搜索区-->
				<form action="" id="search">
					<input type="text" placeholder="请输入搜索内容"/>
					<input type="submit" value="搜索" />
				</form>
				<!--浮层-->
				<ul id="mask">
					<li><a href="javascript:;">首页</a></li>
					<li><a href="javascript:;">MV</a></li>
					<li><a href="javascript:;">悦单</a></li>
					<li><a href="javascript:;">V榜</a></li>
					<li><a href="javascript:;">音悦</a></li>
					<li><a href="javascript:;">商城</a></li>
					<li><a href="javascript:;">节目</a></li>
					<li><a href="javascript:;">饭团</a></li>
					<li><a href="javascript:;">资讯</a></li>
					<li><a href="javascript:;">我的家</a></li>
					<li><a href="javascript:;">APP下载</a></li>
					<li><a href="javascript:;">热门应用</a></li>
				</ul>
			</header>
			<section id="content">
				<div id="inner">
					<!--可拖拽的导航-->
					<div id="navs" >
						<ul class="clearfix">
							<li><a href="javascript:;" class="active">首页</a></li>
							<li><a href="javascript:;">MV</a></li>
							<li><a href="javascript:;">悦单</a></li>
							<li><a href="javascript:;">V榜</a></li>
							<li><a href="javascript:;">音悦</a></li>
							<li><a href="javascript:;">商城</a></li>
							<li><a href="javascript:;">节目</a></li>
							<li><a href="javascript:;">饭团</a></li>
							<li><a href="javascript:;">资讯</a></li>
							<li><a href="javascript:;">我的家</a></li>
							<li><a href="javascript:;">APP下载</a></li>
							<li><a href="javascript:;">热门应用</a></li>
							<li><a href="javascript:;">晓飞张</a></li>
							<li><a href="javascript:;">张晓飞</a></li>
							<li><a href="javascript:;">张小飞</a></li>
							<li><a href="javascript:;">张飞飞</a></li>
							<li><a href="javascript:;">飞不动</a></li>
						</ul>
					</div>
					<!--无缝滑屏-->
					<div id="pic_wrap">
						<ul id="pic_list">
							<li>
								<a href="javascript:;">
									<img src="img/1.jpg"/>
								</a>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/2.jpg"/>
								</a>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/3.jpg"/>
								</a>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/4.jpg"/>
								</a>
							</li>
							<li>
								<a href="javascript:;">
									<img src="img/5.jpg"/>
								</a>
							</li>
						</ul>
						<div id="pic_nav">
							<span class="active"></span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>
						</div>
					</div>
					<!--可切换的选项卡-->
					<div class="tab">
						<header class="tab_h">
							<h2>MV主播</h2>
							<a href="javascript:;">更多&gt;</a>
						</header>
						<div class="tab_navs">
							<a href="javascript:;">全部</a>
							<a href="javascript:;">内地</a>
							<a href="javascript:;">港台</a>
							<a href="javascript:;">欧美</a>
							<a href="javascript:;">韩国</a>
							<a href="javascript:;">日本</a>
							<span></span>
						</div>
						<div class="tab_wrap">
							<ul class="loading"></ul>
							<ul>
								<li>
									<a href="javascript:;">
										<img src="img/a.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/b.jpg"/>
										<span id="">君に贈る花がない君に贈る花がない君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/c.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/d.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/e.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/f.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
							</ul>
							<ul class="loading"></ul>
						</div>
					</div>
					<div class="tab">
						<header class="tab_h">
							<h2>MV主播</h2>
							<a href="javascript:;">更多&gt;</a>
						</header>
						<div class="tab_navs">
							<a href="javascript:;">全部</a>
							<a href="javascript:;">内地</a>
							<a href="javascript:;">港台</a>
							<a href="javascript:;">欧美</a>
							<a href="javascript:;">韩国</a>
							<a href="javascript:;">日本</a>
							<span></span>
						</div>
						<div class="tab_wrap">
							<ul class="loading"></ul>
							<ul>
								<li>
									<a href="javascript:;">
										<img src="img/a.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/b.jpg"/>
										<span id="">君に贈る花がない君に贈る花がない君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/c.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/d.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/e.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/f.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
							</ul>
							<ul class="loading"></ul>
						</div>
					</div>
					<div class="tab">
						<header class="tab_h">
							<h2>MV主播</h2>
							<a href="javascript:;">更多&gt;</a>
						</header>
						<div class="tab_navs">
							<a href="javascript:;">全部</a>
							<a href="javascript:;">内地</a>
							<a href="javascript:;">港台</a>
							<a href="javascript:;">欧美</a>
							<a href="javascript:;">韩国</a>
							<a href="javascript:;">日本</a>
							<span></span>
						</div>
						<div class="tab_wrap">
							<ul class="loading"></ul>
							<ul>
								<li>
									<a href="javascript:;">
										<img src="img/a.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/b.jpg"/>
										<span id="">君に贈る花がない君に贈る花がない君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/c.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/d.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/e.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/f.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
							</ul>
							<ul class="loading"></ul>
						</div>
					</div>
					<div class="tab">
						<header class="tab_h">
							<h2>MV主播</h2>
							<a href="javascript:;">更多&gt;</a>
						</header>
						<div class="tab_navs">
							<a href="javascript:;">全部</a>
							<a href="javascript:;">内地</a>
							<a href="javascript:;">港台</a>
							<a href="javascript:;">欧美</a>
							<a href="javascript:;">韩国</a>
							<a href="javascript:;">日本</a>
							<span></span>
						</div>
						<div class="tab_wrap">
							<ul class="loading"></ul>
							<ul>
								<li>
									<a href="javascript:;">
										<img src="img/a.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/b.jpg"/>
										<span id="">君に贈る花がない君に贈る花がない君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/c.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/d.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/e.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/f.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
							</ul>
							<ul class="loading"></ul>
						</div>
					</div>
					<div class="tab">
						<header class="tab_h">
							<h2>MV主播</h2>
							<a href="javascript:;">更多&gt;</a>
						</header>
						<div class="tab_navs">
							<a href="javascript:;">全部</a>
							<a href="javascript:;">内地</a>
							<a href="javascript:;">港台</a>
							<a href="javascript:;">欧美</a>
							<a href="javascript:;">韩国</a>
							<a href="javascript:;">日本</a>
							<span></span>
						</div>
						<div class="tab_wrap">
							<ul class="loading"></ul>
							<ul>
								<li>
									<a href="javascript:;">
										<img src="img/a.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/b.jpg"/>
										<span id="">君に贈る花がない君に贈る花がない君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/c.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/d.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/e.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
								<li>
									<a href="javascript:;">
										<img src="img/f.jpg"/>
										<span id="">君に贈る花がない</span>
									</a>
									<div class="tab_ice">
										<div class="tab_ice_l">
											<span class="tab_ice_l_pic"></span>
											<span>9877</span>
										</div>
										<div class="tab_ice_r">
											<span class="tab_ice_r_pic"></span>
											<span>9</span>
										</div>
									</div>
								</li>
							</ul>
							<ul class="loading"></ul>
						</div>
					</div>
				</div>	
			</section>
			<div id="scrollBar"></div>
		</section>
	</body>
	<script src="js/transform.js"></script>
	<script type="text/javascript">
	window.onload=function(){
		//取消移动端所有的默认行为
		document.addEventListener("touchstart",function(ev){
			ev=ev||event;
			//chrome的桌面模拟环境底下会失效   在真机的webview底下工作是正常的
			ev.preventDefault();			
		});
		
		//rem适配
		(function(){
			var styleNode = document.createElement("style");
			var width = document.documentElement.clientWidth;
			styleNode.innerHTML = "html{font-size:"+(width/16)+"px!important}";
			document.head.appendChild(styleNode);
		})()
		
		
		//自定义竖向滑屏，自定义滚动条
		definedByMyself();
		function definedByMyself(){
			var wrap = document.querySelector("#content");
			var bar = document.querySelector("#scrollBar");
			var inner = document.querySelector("#inner");
			var search = document.querySelector("#search");
			var headT = document.querySelector("#headT");
			var head = document.querySelector("#head");
			// 视口的高度 /内容区的高度  = 滚动条的高度/视口的高度
			var scale = document.documentElement.clientHeight / inner.offsetHeight;
			
			bar.style.height = document.documentElement.clientHeight*scale+"px";
			
			var callback={
				start:function(){
					bar.style.opacity=1;
				},
				move:function(){
					//滚动条滑动的实时距离/滚动条能滑动的最大距离  = 内容区滑动的实时距离/内容区能滑动的最大距离
					var scale2 = Math.abs(css(inner,"translateY")) /(inner.offsetHeight - wrap.clientHeight)
					var y = (document.documentElement.clientHeight - bar.offsetHeight)*scale2;
					css(bar,"translateY",y);
					
					if(y>headT.offsetHeight){
						search.style.display="none";
					}else{
						search.style.display="block";
					}
				},
				end:function(){
					bar.style.opacity=0;
				}
			}
			damu.drag(wrap,callback);
		}
		
		
		
		
		/*
		 * 移动端存值存址
		 * 在一些移动端浏览器上，事件内的event对象会有传址的现象存在
		 * 
		 * */
		//可切换的选项卡
		tab();
		function tab(){
			var wraps = document.querySelectorAll(".tab_wrap");
			var navs = document.querySelectorAll(".tab_navs");
			var translateX = navs[0].offsetWidth;
			for(var i=0;i<wraps.length;i++){
				move(wraps[i],navs[i]);
			}
			
			function move(wrap,nav){
				//开启3d硬件加速
				css(wrap,"translateZ",0.1);
				var loadings = wrap.querySelectorAll(".loading");
				var smallGreen = nav.querySelector(".tab_navs span");
				//开启3d硬件加速
				css(smallGreen,"translateZ",0.1);
				var aNodes = nav.querySelectorAll(".tab_navs a");
				/*
					向右滑:now -1
					向左滑:now +1
					做无缝
				*/
				var now = 0;
				//位置的调整
				css(wrap,"translateX",-translateX);
				
				var elementPoint = {x:0,y:0};
				var startPoint = {x:0,y:0};
				
				var isFirst = true;
				var isX = true;
				var isLoad = false;
				wrap.addEventListener("touchstart",function(ev){
					if(isLoad){
						return;
					}
					wrap.style.transition ="none";
					
					ev=ev||event;
					var touchC = ev.changedTouches[0];
					
					elementPoint.x = css(wrap,"translateX");
					elementPoint.y = css(wrap,"translateY");
//					startPoint.x = touchC.clientX;
//					startPoint.y= touchC.clientY;
					//快照
					startPoint = {clientX:touchC.clientX,clientY:touchC.clientY};
					
				 	isFirst = true;
				 	isX = true;
				})
				wrap.addEventListener("touchmove",function(ev){
					if(isLoad){
						return;
					}
					if(!isX){
						return;
					}
					
					ev=ev||event;
					var touchC = ev.changedTouches[0];
					
					var nowPoint = {x:0,y:0};
//					nowPoint.x = touchC.clientX;
//					nowPoint.y= touchC.clientY;
					nowPoint=touchC ; 
					var dis={x:0,y:0};
//					dis.x=nowPoint.x - startPoint.x;
//					dis.y=nowPoint.y - startPoint.y;
					dis.x=nowPoint.clientX - startPoint.clientX;//0
					dis.y=nowPoint.clientY - startPoint.clientY;//0
					
					
					if(isFirst){
						isFirst = false;
						if(Math.abs(dis.x)<Math.abs(dis.y)){
							isX =false;
							return;
						}
					}
					css(wrap,"translateX",elementPoint.x+dis.x);
					
					if(Math.abs(dis.x)>translateX/2){
						end(dis.x);
					}
					
				})
				wrap.addEventListener("touchend",function(ev){
					if(isLoad){
						return;
					}
					ev=ev||event;
					var touchC = ev.changedTouches[0];
//					var nowPoint = {x:0,y:0};
//					nowPoint.x=touchC.clientX;
//					nowPoint.y=touchC.clientY;
					var nowPoint = touchC;
					var dis = {x:0,y:0};
					
					dis.x=nowPoint.clientX - startPoint.clientX;
					dis.y=nowPoint.clientY - startPoint.clientY;
					
					if(Math.abs(dis.x)<translateX/2){
						wrap.style.transition =".5s";
						css(wrap,"translateX",-translateX);
					}
				})
			
				//大于二分之一的跳转
				function end(disX){
					isLoad = true;
					//1:向右  -1：向左
					var dir = disX/Math.abs(disX);
					var target = dir>0?0:-2*translateX;
					wrap.style.transition=".5s";
					css(wrap,"translateX",target);
					
					//向右滑:now -1
					now -= dir;
//					if(disX>0){
//						now--;
//					}else{
//						now++;
//					}
					//无缝
					if(now<0){
						now=aNodes.length-1;
					}else if(now>aNodes.length-1){
						now = 0;
					}
					wrap.addEventListener("transitionend",transitionend);
					wrap.addEventListener("webkitTransitionEnd",transitionend);
					
				}
				
				function transitionend(){
					wrap.removeEventListener("transitionend",transitionend);
					wrap.removeEventListener("webkitTransitionEnd",transitionend);
					
					//让小绿动起来
					css(smallGreen,"translateX",aNodes[now].offsetLeft);
					
					
					for(var i=0;i<loadings.length;i++){
						loadings[i].style.opacity=1;
					}
					
					//发ajax
					setTimeout(function(){
						
						//请求数据
						//操作dom
						isLoad = false;
						for(var i=0;i<loadings.length;i++){
							loadings[i].style.opacity=0;
						}
						css(wrap,"translateX",-translateX);
						wrap.style.transition="none";
						
						
					},1000);
				}
			}
			
			
		}
		
		//无缝滑屏
		seamless();
		function seamless(){
			//获取元素
//			var cssNode = document.querySelector("#css");
			var cssNode = document.createElement("style");
			var wrap = document.querySelector("#pic_wrap");
			var list = document.querySelector("#pic_list");
				css(list,"translateZ",0.1);
				list.innerHTML +=list.innerHTML;
			var imgNodes = document.querySelectorAll("#pic_list img");
			var spanNodes =document.querySelectorAll("#pic_nav span");
			
		
			//变量的申明
			var clearTime=undefined;
			//list的宽度要变成视口的宽度*图片的数量
			var cssText ="#pic_list{width:"+imgNodes.length+"00%}";
				cssText+="#pic_list li{width:"+((1/imgNodes.length)*100)+"%}";
				setTimeout(function(){
					cssText+="#pic_wrap{height:"+imgNodes[0].offsetHeight+"px}";
					cssNode.innerHTML+=cssText;
					document.head.appendChild(cssNode);
				},20)
			//滑屏
			var elementPoint = {x:0,y:0};
			var startPoint={x:0,y:0};
			
			//判断用户首次操作的方向
			var isFirst = true;
			var isX = true;
			
			wrap.addEventListener("touchstart",function(ev){
				var ev =ev||event;
				var touchChange = ev.changedTouches[0];
				
				isX = true;
				isFirst =true;
				//告诉定时器的停止工作
				clearInterval(clearTime);
				
				list.style.transition="none";
				//实现 无缝
				var left = css(list,"translateX");
				now =-left/document.documentElement.clientWidth;
				if(now==0){
					now=spanNodes.length;
				}else if(now==imgNodes.length-1){
					now=spanNodes.length-1;
				}
				css(list,"translateX",-now*document.documentElement.clientWidth);
				
				
				elementPoint.x=css(list,"translateX");
				elementPoint.y=css(list,"translateY");
				startPoint.x = touchChange.clientX;
				startPoint.y = touchChange.clientY;
			})
			wrap.addEventListener("touchmove",function(ev){
				/*防抖动
				 * 
				 * 判断用户的首次！！！！滑屏方向
				 * 			如果是竖向的滑屏--->禁止掉横向无缝的所有逻辑
				 * 
				 * 			如果是横向的滑屏--->放开横向无缝的所有逻辑
				 * */
				
				if(!isX){
					//如果第一次操作是竖向的，那用户之后的所有操作靠这个return来禁止
					return;
				}
				
				var ev =ev||event;
				var touchChange = ev.changedTouches[0];
				
				var nowPoint = {x:0,y:0};
				nowPoint.x=touchChange.clientX;
				nowPoint.y=touchChange.clientY;
				var disX = nowPoint.x-startPoint.x;
				var disY = nowPoint.y-startPoint.y;
				
				
				if(isFirst){
					isFirst =false;
					if(Math.abs(disY) > Math.abs(disX)){
						//在y轴上滑动
						isX = false;
						//如果用户第一次操作是竖向的，那无缝滑屏的所有逻辑靠这个return来禁止
						return;
					}
				}
				
				
				
				css(list,"translateX",elementPoint.x+disX);
			})
			wrap.addEventListener("touchend",function(ev){
				var ev =ev||event;
				var touchChange = ev.changedTouches[0];
				
				
				
				var left = css(list,"translateX");
				//抽象ul的位置 单位是一个视口 也可以图片的下标
				now =-left/document.documentElement.clientWidth;
				if(now<0){
					now=0;
				}else if(now>imgNodes.length-1){
					now=imgNodes.length-1;
				}
				
				now = Math.round(now);
				
				autoMove();
				//重新开启定时器
//				auto();
			})
			
			
//			auto();
			//自动轮播
			var now=0;
			function auto(){
				clearInterval(clearTime);
				clearTime=setInterval(function(){
					
					if(now==imgNodes.length-1){
						list.style.transition="none";
						now = spanNodes.length-1;
						css(list,"translateX",-now*document.documentElement.clientWidth);
					}
					
					setTimeout(function(){
						now++;
						autoMove();
					},20)
					
				},1000)
			}
			
			function autoMove(){
				list.style.transition=".5s ";
				css(list,"translateX",-now*document.documentElement.clientWidth);
				//处理小圆点
				for(var i=0;i<spanNodes.length;i++){
					spanNodes[i].className ="";
				}
				spanNodes[now%spanNodes.length].className="active";
			}
			
		}
		
		
		//点击变色
		changeColor();
		function changeColor(){
			var liNodes = document.querySelectorAll("#navs ul li a");
			var ul = document.querySelector("#navs ul");
			
			var startPoint =0;
			ul.addEventListener("touchstart",function(ev){
					ev= ev||event;
					startPoint = ev.changedTouches[0].clientX;
					this.isMove=false;
			})
			
			ul.addEventListener("touchmove",function(ev){
				ev= ev||event;
				var nowPoint = ev.changedTouches[0].clientX;
				if(!this.isMove&&(Math.abs(nowPoint-startPoint)>1)){
					this.isMove=true;
				}
			})
			
			ul.addEventListener("touchend",function(ev){
				ev=ev||event;
				var  touchC = ev.changedTouches[0];
				if(!this.isMove){
					for(var j=0;j<liNodes.length;j++){
						liNodes[j].className="";
					}
//					if(touchC.target.nodeName.toUpperCase()==="LI"){
//						touchC.target.className="active";
//					}else if(touchC.target.nodeName.toUpperCase()==="A"){
//						touchC.target.parentNode.className="active";
//					}
					touchC.target.className="active";
				}
			
			})
			
			
//			for(var i=0;i<liNodes.length;i++){
//				liNodes[i].addEventListener("touchstart",function(){
//						this.isMove=false;
//				})
//				
//				liNodes[i].addEventListener("touchmove",function(){
//					if(!this.isMove){
//						this.isMove=true;
//					}
//				})
//				
//				
//				liNodes[i].addEventListener("touchend",function(){
//					if(!this.isMove){
//						for(var j=0;j<liNodes.length;j++){
//							liNodes[j].className="";
//						}
//						this.className="active";
//					}
//					
//				})
//			}
		}
		
		
		//可拖拽的导航
		drag();
		function drag(){
			//滑屏区域
			var wrap = document.querySelector("#navs");
			var item =document.querySelector("#navs ul");
			css(item,"translateZ",0.1);
			
			var elementX = 0;
			var startX = 0;
			var minX = wrap.clientWidth - item.offsetWidth;
			
			//上一次的时间
			var lastTime =0;
			//上一次的位置
			var lastPoint=0;
			//时间差   不出现NaN
			var timeDis = 1;
			//位置差
			var pointDis =0;
			
			wrap.addEventListener("touchstart",function(ev){
				ev=ev||event;
				var touchC = ev.changedTouches[0];
				item.style.transition="none";
				elementX=css(item,"translateX");
				startX=touchC.clientX;
				
				lastTime = new Date().getTime();
				lastPoint = css(item,"translateX");
				
				//清除速度
				pointDis=0;
			})
			wrap.addEventListener("touchmove",function(ev){
				ev=ev||event;
				var touchC = ev.changedTouches[0];
				var nowX =touchC.clientX;
				//每次手指滑动的距离
				var disX = nowX - startX;
				
				var translateX =elementX+disX;
				
				console.log(translateX,minX);
				
				var scale=0;
				if(translateX>0){
					//左边的留白：translateX
					//将scale完全控制在0-1之间
//					scale = 1-translateX/document.documentElement.clientWidth;
					scale = document.documentElement.clientWidth/(document.documentElement.clientWidth+translateX);
					translateX = elementX+(disX*scale);
				}else if(translateX<minX){
					//右边的留白：
					var space = minX - translateX;
					scale = document.documentElement.clientWidth/(document.documentElement.clientWidth+space);
					translateX = elementX+(disX*scale);
				}
				
				//让item滑起来
				css(item,"translateX",translateX);
				
				
				var nowTime = new Date().getTime();
				var nowPoint = css(item,"translateX");
				timeDis = nowTime - lastTime;
				pointDis = nowPoint -lastPoint;
				
				lastTime = nowTime;
				lastPoint = nowPoint;
			})
			wrap.addEventListener("touchend",function(){
				//touchend时的速度
				var speed = pointDis / timeDis;
				var target = css(item,"translateX")+speed*200;
				var time =  Math.abs(speed) *0.2;
				time =time<0.3?0.3:time;
//				console.log("目标位置："+target+";速度："+speed+";时间："+time)
				var Bessel="";
				if(target>0){
					target=0;
					Bessel="cubic-bezier(.19,1.38,.52,1.32)";
				}else if(target<minX){
					target=minX;
					Bessel="cubic-bezier(.19,1.38,.52,1.32)";
				}
				item.style.transition=time+"s "+Bessel;
				css(item,"translateX",target);
			})
		}
		
		
		//菜单切换
		CMFCMenuBar();
		function CMFCMenuBar(){
			var menuBtn = document.querySelector("#menuBtn");
			var mask = document.querySelector("#mask");
			menuBtn.addEventListener("touchstart",function(ev){
				ev=ev||event;
				
				if(menuBtn.className=="menuBtnClos"){
					menuBtn.className="menuBtnOpen";
					mask.style.display="block";
				}else if(menuBtn.className=="menuBtnOpen"){
					menuBtn.className="menuBtnClos";
					mask.style.display="none";
				}
				
				ev.stopPropagation();
			})
			
			document.addEventListener("touchstart",function(){
				if(menuBtn.className=="menuBtnOpen"){
					menuBtn.className="menuBtnClos";
					mask.style.display="none";
				}
			})
			
			mask.addEventListener("touchstart",function(ev){
				ev=ev||event;
				ev.stopPropagation();
				ev.preventDefault();
			})
		}
		
		
		//处理失焦获焦事件
		changeFocus();
		function changeFocus(){
			//获取元素  重绘重排后 querySelector的整个获取dom元素的机制会失效
			var searchText = document.querySelector("#search input[type=text]");
			var liNodes = document.querySelectorAll("#mask li");
			searchText.addEventListener("touchstart",function(ev){
				ev=ev||event;
				this.focus();
				ev.stopPropagation();
				ev.preventDefault();
			});
			document.addEventListener("touchstart",function(){
				searchText.blur();
			})
		}
		
	}	
	</script>
</html>